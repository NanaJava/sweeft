DROP TABLE IF EXISTS Teacher;
DROP TABLE IF EXISTS Pupil;


CREATE TABLE Teacher(
	id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  first_name TEXT,
  last_name TEXT,
  sex TEXT,
  subject TEXT
);

CREATE TABLE Pupil(
	id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
  first_name TEXT,
  last_name TEXT,
  sex TEXT,
  class TEXT
);

CREATE TABLE Mapping(
  id INT NOT NULL AUTO_INCREMENT,
  teacher_id INT NOT NULL,
  pupil_id INT NOT NULL,
  PRIMARY KEY(id),
  FOREIGN KEY(teacher_id) REFERENCES Teacher(id),
  FOREIGN KEY(pupil_id) REFERENCES Pupil(id)
);

INSERT INTO Teacher(first_name, last_name, sex, subject) VALUES ("john", "doe", "male", "math");
INSERT INTO Teacher(first_name, last_name, sex, subject) VALUES ("jane", "austin", "female", "english");
INSERT INTO Teacher(first_name, last_name, sex, subject) VALUES ("jane", "eyre", "female", "german");
INSERT INTO Teacher(first_name, last_name, sex, subject) VALUES ("kate", "bush", "female", "megrelian");

INSERT INTO Pupil(first_name, last_name, sex, class) VALUES ("ana", "onofrishvili", "female", "10");
INSERT INTO Pupil(first_name, last_name, sex, class) VALUES ("ana", "gelashvili", "female", "11");
INSERT INTO Pupil(first_name, last_name, sex, class) VALUES ("giorgi", "mamukashvili", "male", "12");
INSERT INTO Pupil(first_name, last_name, sex, class) VALUES ("jane", "doe", "female", "7");
INSERT INTO Pupil(first_name, last_name, sex, class) VALUES ("giorgi", "doe", "male", "8");
INSERT INTO Pupil(first_name, last_name, sex, class) VALUES ("sali", "anika", "female", "9");

INSERT INTO Mapping(teacher_id, pupil_id) VALUES (1, 2);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (1, 3);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (1, 4);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (2, 3);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (2, 6);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (3, 1);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (4, 5);
INSERT INTO Mapping(teacher_id, pupil_id) VALUES (4, 6);

SELECT * FROM Teacher t 
 WHERE t.id IN (
    SELECT m.teacher_id FROM Mapping m
     WHERE m.pupil_id IN (
        SELECT p.id FROM Pupil p
         WHERE p.first_name = "giorgi"
    )
 );

SELECT * FROM Teacher;
SELECT * FROM Pupil;
SELECT * FROM Mapping;